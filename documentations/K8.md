# k8

## general concept, what's k8? 

Kubernetes (K8s) is a container orchestration platform.
It automatically manages, deploys, scales, and maintains containerized applications across multiple machines.

Instead of manually running containers on servers, Kubernetes:
- Decides where containers run
- Restarts them if they crash
- Scales them up/down
- Manages networking between them
- Stores configuration and secrets
> It turns a group of machines into a cluster that behaves like one powerful system.

---

## structure/archintecture
- docker
- containter runtime : software that actually runs containers
- pod
- node
- cublet
- cube proxy
- control plane (controller manager / scheduler / ETCD / API server)
- control plane 
- master node 
- server node
- worker node
- agent node 


### containter runtime
the software that actually runs containers.
Kubernetes does not directly run containers.
It talks to the container runtime via CRI (Container Runtime Interface).

### pod

A Pod is the smallest deployable unit in Kubernetes.
- Contains one or more containers
- Containers inside a pod share:
 - Network (same IP)
 - Storage
- Usually 1 container per pod (best practice)
> like a wrapper around containers.

### node 

A Node is a machine in the cluster
It can be:
- Physical server
- Virtual machine

2 main types:
- Control Plane node
- Worker node


## Kubelet (= â€œcubletâ€)

- Kubelet runs on every node.
- It:
    - Talks to API Server
    - Starts/stops pods
    - Makes sure containers are running
- the agent of Kubernetes on each machine.

## Kube-proxy
- Kube-proxy handles networking.
- It:
    - Maintains networking rules
    - Allows communication between pods
    - Enables Services (stable access to pods)


### control plane node (old name = master node) (Standard Kubernetes)

The Control Plane manages the entire cluster.

It includes:

#### 1. API Server

- Entry point of Kubernetes
- All communication goes through it
- Accepts kubectl commands

#### 2. ETCD

- Key-value database
- Stores cluster state
- If etcd is lost â†’ cluster is lost

#### 3. Scheduler

Decides which node runs a new pod

#### 4. Controller Manager

- Watches cluster state
- Fixes problems automatically

### worker node (Standard Kubernetes)

A Worker Node is a machine that:
- Runs application workloads
- Hosts Pods
- Does NOT run control plane components

It runs:
- kubelet
- kube-proxy
- container runtime (containerd / CRI-O)

> Its job is simple:
> Execute the containers assigned by the control plane.


---


## NOTES! server node (in K3s)

In K3s:
Server node = Control Plane node

Runs:
API server
Scheduler
Controller
etcd (or embedded DB)

> in K3s:
> Server node = Control Plane node

### NOTES! agent node (in K3s)

In K3s:
- Agent Node = Worker Node
- It connects to a Server Node

It runs:
- kubelet
- container runtime
- networking components

---

## summary 


Think of Kubernetes like this:
- Control Plane = Brain
- Nodes = Workers
- Pods = Tasks
- Container Runtime = Hands executing work
- Kubelet = Supervisor on each worker

In K3s specifically:
- Server node = Brain
- Agent node = Worker



| Concept           | What It Is                 | Role                   | Runs What?           |
| ----------------- | -------------------------- | ---------------------- | -------------------- |
| Kubernetes        | Container orchestrator     | Manages cluster        | Everything           |
| Docker            | Container platform         | Builds/runs containers | Containers           |
| Container Runtime | Low-level container engine | Executes containers    | containerd / CRI-O   |
| Pod               | Smallest deployable unit   | Wraps containers       | Containers           |
| Node              | Machine in cluster         | Hosts pods             | Kubelet + runtime    |
| Kubelet           | Node agent                 | Manages pods           | Talks to API server  |
| Kube-proxy        | Network component          | Pod communication      | Network rules        |
| Control Plane     | Cluster brain              | Makes decisions        | API, scheduler, etcd |
| Master Node       | Old name                   | Control plane node     | Control plane        |
| Server Node (K3s) | K3s control plane          | Brain of K3s           | Control plane        |
| Worker Node       | Runs workloads             | Executes pods          | Pods                 |
| Agent Node (K3s)  | K3s worker                 | Runs pods              | Pods                 |


### k8 vs k3s terms 
| Standard Kubernetes | K3s         |
| ------------------- | ----------- |
| Worker Node         | Agent Node  |
| Control Plane Node  | Server Node |


---

## resources 

- [Kubernetes Explained in 6 Minutes | k8s Architecture](https://www.youtube.com/watch?v=TlHvYWVUZyc)
- [Kubernetes Explained in 100 Seconds](https://www.youtube.com/watch?v=PziYflu8cB8)
- [Kubernetes Architecture explained | Kubernetes Tutorial 15](https://www.youtube.com/watch?v=umXEmn3cMWY)
- [Kubernetes Architecture Explained ðŸ§  | Control Plane vs Worker Nodes](https://www.youtube.com/watch?v=-tH6rDlg5Nw)


##### 3 node processes:
> must be installed on every node
1. kubelet  
2. kube proxy
3. container runtime


master processes (master nodes)
1. API server (cluster gateway, kinda like firewall -> validate request -> other processes (nodes) to execute and response
2. Scheduler (traffic) 
> check request (how much RAM resources needed) -> JUSt DECIDE where to put the pod? (kubelet actually execute) 
3. controller manager -> detect cluster change changes
> controller manager -> scheduler -> kublet 
4. etcd : cluster brain (data!) 
> cluster changes stored in the key-value store